Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Running in parallel on 20 cores
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Now performing an optimization...
Run 0 finished with value 0.8656092089660606
Now performing an optimization...
Traceback (most recent call last):
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/simphony/models.py", line 112, in __init__
    self.pins = PinList(self, len(self.__class__.pins))
AttributeError: type object 'ActivatedLayer' has no attribute 'pins'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/simphony/models.py", line 116, in __init__
    self.pins = PinList(self, self.__class__.pin_count)
AttributeError: type object 'ActivatedLayer' has no attribute 'pin_count'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/mpi4py/__main__.py", line 7, in <module>
    main()
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/mpi4py/run.py", line 198, in main
    run_command_line(args)
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/mpi4py/run.py", line 47, in run_command_line
    run_path(sys.argv[0], run_name='__main__')
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/runpy.py", line 268, in run_path
    return _run_module_code(code, init_globals, run_name,
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/runpy.py", line 97, in _run_module_code
    _run_code(code, mod_globals, init_globals,
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "optimizer.py", line 118, in <module>
    x = solver.optimize(design)
  File "/fslhome/ihammond/miniconda3/envs/emepy/lib/python3.9/site-packages/nlopt/nlopt.py", line 334, in optimize
    return _nlopt.opt_optimize(self, *args)
  File "optimizer.py", line 75, in f
    f0, dJ_du, monitor = optimizer.optimize(design)
  File "/zhome/ihammond/GitHub/emepy/emepy/optimization.py", line 268, in optimize
    # Compute the forward run
  File "/zhome/ihammond/GitHub/emepy/emepy/optimization.py", line 154, in forward_run
    self.eme.propagate()
  File "/zhome/ihammond/GitHub/emepy/emepy/eme.py", line 598, in propagate
    self.solve_modes()
  File "/zhome/ihammond/GitHub/emepy/emepy/eme.py", line 160, in solve_modes
    solved = layer.finish_activate(sources=sources, start=length, period_length=self._get_total_length(), mode_solver=mode_solver)
  File "/zhome/ihammond/GitHub/emepy/emepy/models.py", line 40, in finish_activate
    return self.activate_layer(sources,start,period_length,False)
  File "/zhome/ihammond/GitHub/emepy/emepy/models.py", line 87, in activate_layer
    self.activated_layers[per] += [ActivatedLayer(modes, self.wavelength, self.length)]
  File "/zhome/ihammond/GitHub/emepy/emepy/models.py", line 325, in __init__
    super().__init__(**kwargs, pins=pins)
  File "/fslhome/ihammond/.local/lib/python3.9/site-packages/simphony/models.py", line 119, in __init__
    raise NotImplementedError(
NotImplementedError: ActivatedLayer.pin_count or ActivatedLayer.pins needs to be defined.
--------------------------------------------------------------------------
MPI_ABORT was invoked on rank 0 in communicator MPI_COMM_WORLD 
with errorcode 1.

NOTE: invoking MPI_ABORT causes Open MPI to kill all MPI processes.
You may or may not see output from other processes, depending on
exactly when Open MPI kills them.
--------------------------------------------------------------------------
