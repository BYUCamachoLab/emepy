Running in parallel on 20 cores
*** TESTING GRADIENT ADJOINT ***
Now performing an optimization...

step size: 1e-05
Adjoint FOM: 1.9521019707102925
Adjoint gradient: [-19734.51262397+11332.89468063j   3738.41928916  +355.27061426j
  -8995.79814786-13746.82912355j   3401.61061392 +6115.76362621j
  10437.22854782 -5811.09358922j  -3315.93633465 +2820.827173j
  10603.52139143+13046.83082697j   -879.47724227 +2695.13020493j
 -10822.83007732+10109.39839662j   4272.06252959 +1741.88364326j
 -13096.14012128 -8801.88184067j   7068.27862992 +4662.51375209j
   5262.38851598 -8481.15304061j   -190.21956475 +3476.09921287j
   8660.2261997  +6662.15096101j   1675.13269322 +2618.82027542j
  -5069.17941434+17654.11989693j   1876.42480515 +2484.05348909j
 -21094.17550125  +363.17137981j   9939.41729977 +3266.71263101j
  -2974.45065893-12786.72008595j   5072.98778593 +4615.07778296j
  10944.19198216 -2755.23074626j  -1171.89214113 -1680.41690127j
   6274.17027457+12839.91974917j  -2067.55264459  +621.08971161j
 -12398.5995409  +7664.74735628j   6978.20249918 +1389.98974579j
 -10170.49699043-12363.35676111j   6313.24503426 +1832.97521471j
   8669.49312536-10172.81299509j  -3453.31248848  +404.87535939j
   9053.3751822  +5936.18909115j  -2079.26714256 +1820.72714677j
  -5092.1235446 +13537.12535951j   4817.87217233  -293.61938753j
  -9707.92011846 -1063.92418309j   5783.85857187 -1080.16971682j
   -708.96352784 -8502.23893181j    956.79029514  -226.2668298j
   8167.63087879  -526.68329807j  -4003.85265725 -2422.19837574j
   1066.2955815 +10222.14553928j  -3627.38334602 -2100.40344086j
  -7574.51747472 +2927.66288944j  -2314.32027991  +630.67873679j
  -6671.22656746 -7895.75409006j   -504.04303931  +893.08337923j
   5190.53545629 -6222.65542817j  -3518.95218896 +2782.52663767j
   6645.6542957  +6536.98527646j  -2818.58231085 +1578.64443263j
  -5067.94670546 +6521.48604433j    108.00616235 +1746.38517615j
  -6339.87039258 -4002.11981476j   2991.20484029 +2633.53365059j
   1491.3617794  -5579.03259057j   -191.75498447 +3040.47707313j
   3672.7592312   +383.15023425j   -488.06704602  +266.56521545j]

step size: 1e-05
idx: range(0, 6)
Adjoint FOM: 1.9521019707102925
Adjoint gradient: [-19734.51262397+11332.89468063j   3738.41928916  +355.27061426j
  -8995.79814786-13746.82912355j   3401.61061392 +6115.76362621j
  10437.22854782 -5811.09358922j  -3315.93633465 +2820.827173j  ]

FD FOM: 1.9502891937504148
FD gradient: [0.15931043092498598, 0.1997558059740889, 0.12597301687344853, 0.137216616946656, 0.07620233875016424, 0.080181746375807]

Now performing an optimization...

step size: 1e-06
Adjoint FOM: 1.9521019874897523
Adjoint gradient: [-19733.35261646+11332.76715142j   3740.02008886  +356.3277447j
  -8998.54518465-13746.94820625j   3401.18178082 +6116.18483711j
  10437.78419426 -5812.46240669j  -3316.60338783 +2821.2436525j
  10604.849096  +13047.59349627j   -879.93438737 +2693.68226059j
 -10823.18324448+10110.64724709j   4273.26767779 +1741.35617396j
 -13096.61763166 -8801.73178689j   7069.10731918 +4663.65652274j
   5262.50178185 -8481.85794464j   -190.96753176 +3477.02406805j
   8660.19701744 +6661.92567843j   1674.9033396  +2618.14859446j
  -5068.26968619+17656.06189948j   1877.57681858 +2482.57059777j
 -21094.58780191  +363.85413402j   9941.53823021 +3267.52788768j
  -2975.5418539 -12788.13272358j   5073.32293058 +4615.44433345j
  10940.08781904 -2752.77209243j  -1172.73507368 -1680.58935407j
   6275.3736403 +12840.90552417j  -2067.53506972  +620.20742377j
 -12399.03699015 +7665.79510997j   6979.39619902 +1390.38129943j
 -10172.04655014-12364.01714925j   6313.6050044  +1833.90377866j
   8669.2795878 -10173.86924587j  -3454.78690753  +405.13472648j
   9054.9338491  +5935.96389078j  -2080.34261844 +1820.49402797j
  -5091.71741318+13537.95967221j   4820.01311993  -293.90953725j
  -9708.65552629 -1063.46143016j   5785.28441262 -1080.2030115j
   -709.29092829 -8503.03826618j    956.44728695  -225.72905121j
   8164.60557909  -526.93405255j  -4003.9243957  -2422.47386335j
   1066.84273176+10222.97632213j  -3626.98033887 -2101.22177889j
  -7574.69261833 +2928.22339001j  -2313.43110539  +630.52293169j
  -6671.7042945  -7895.50406896j   -503.96026268  +894.07870109j
   5189.86872623 -6223.90723039j  -3519.39188415 +2782.35461082j
   6645.05409149 +6536.47016452j  -2818.77143573 +1578.30680927j
  -5066.02344958 +6519.84090783j    108.3887166  +1745.92968872j
  -6341.09811783 -4001.51498751j   2991.13567362 +2633.83003641j
   1490.87927685 -5579.57265167j   -191.97950913 +3040.74426038j
   3673.32783006  +382.93566866j   -488.54703201  +266.63301174j]

step size: 1e-06
idx: range(0, 6)
Adjoint FOM: 1.9521019874897523
Adjoint gradient: [-19733.35261646+11332.76715142j   3740.02008886  +356.3277447j
  -8998.54518465-13746.94820625j   3401.18178082 +6116.18483711j
  10437.78419426 -5812.46240669j  -3316.60338783 +2821.2436525j ]

FD FOM: 1.9502890605247156
FD gradient: [-1.0988155054736382, -0.18618624431088193, -0.3269349067025473, 1.350915076470116, 0.12361008949746122, -0.012763112899882856]

Now performing an optimization...

step size: 1e-07
Adjoint FOM: 1.9521018585107923
Adjoint gradient: [-19733.17985952+11332.78057946j   3740.17445277  +356.42817929j
  -8998.8060873 -13746.93243837j   3401.1336452  +6116.21527203j
  10437.84114029 -5812.58773958j  -3316.67043983 +2821.28052945j
  10604.99702407+13047.67279107j   -879.97687113 +2693.53719072j
 -10823.19551301+10110.77456755j   4273.38594774 +1741.30221262j
 -13096.65247792 -8801.70525117j   7069.18315652 +4663.76463074j
   5262.51227266 -8481.90570736j   -191.0422891  +3477.11158183j
   8660.19668876 +6661.92457445j   1674.88147779 +2618.08557268j
  -5068.16640318+17656.26422443j   1877.69255991 +2482.42524471j
 -21094.61133818  +363.92525293j   9941.74172136 +3267.60633567j
  -2975.64416477-12788.25299791j   5073.351      +4615.47753798j
  10939.6622097  -2752.49448739j  -1172.81570317 -1680.60941684j
   6275.45746222+12841.03823171j  -2067.53317189  +620.11676098j
 -12399.11090189 +7665.92326898j   6979.52093665 +1390.41433904j
 -10172.20987779-12364.044338j     6313.64751828 +1833.98776242j
   8669.26534605-10173.90521586j  -3454.9366125   +405.1413089j
   9055.09333596 +5936.01680016j  -2080.45235581 +1820.46191902j
  -5091.68976948+13538.07898425j   4820.23238575  -293.93116452j
  -9708.74194384 -1063.4236875j    5785.43460044 -1080.20457371j
   -709.33071941 -8503.13483482j    956.41314037  -225.67528077j
   8164.29923541  -526.96879443j  -4003.93037066 -2422.49851358j
   1066.88942227+10223.05846568j  -3626.93887149 -2101.30056195j
  -7574.71822717 +2928.28706746j  -2313.34460686  +630.50972706j
  -6671.76082825 -7895.46883949j   -503.95197997  +894.17778189j
   5189.7964572  -6224.02350774j  -3519.43287135 +2782.33297893j
   6644.98350118 +6536.42004419j  -2818.79063804 +1578.27067334j
  -5065.84260059 +6519.66308045j    108.42478168 +1745.88359689j
  -6341.22087712 -4001.46825223j   2991.12779061 +2633.865994j
   1490.84272569 -5579.60530116j   -192.00739168 +3040.76362959j
   3673.39184135  +382.95957357j   -488.59630939  +266.63548331j]

step size: 1e-07
idx: range(0, 6)
Adjoint FOM: 1.9521018585107923
Adjoint gradient: [-19733.17985952+11332.78057946j   3740.17445277  +356.42817929j
  -8998.8060873 -13746.93243837j   3401.1336452  +6116.21527203j
  10437.84114029 -5812.58773958j  -3316.67043983 +2821.28052945j]

FD FOM: 1.9502885200100657
FD gradient: [-0.14627039357506533, -2.840062331976867, -2.5882839937985125, -0.6220213388807849, 0.29906829679404723, 1.921967150986248]

Now performing an optimization...

step size: 1e-08
Adjoint FOM: 1.9521017951340582
Adjoint gradient: [-19733.20236376+11332.71552179j   3740.19315245  +356.44822373j
  -8998.8322924 -13746.98126957j   3401.12825575 +6116.23951036j
  10437.8621641  -5812.62898697j  -3316.68259234 +2821.29527137j
  10605.02049426+13047.65653971j   -879.98224151 +2693.52113094j
 -10823.19929652+10110.76797516j   4273.39837762 +1741.29886852j
 -13096.65605968 -8801.73198803j   7069.19078114 +4663.79111438j
   5262.51389051 -8481.95612602j   -191.0499571  +3477.13184722j
   8660.19886275 +6661.88650825j   1674.88006045 +2618.07163429j
  -5068.14803287+17656.26334601j   1877.70460485 +2482.40510521j
 -21094.60283745  +363.93363903j   9941.75711438 +3267.61256395j
  -2975.64771909-12788.27068276j   5073.3517936  +4615.47920572j
  10939.63664549 -2752.49345344j  -1172.82720223 -1680.6065593j
   6275.50780086+12840.99729628j  -2067.53238157  +620.10829633j
 -12399.07221685 +7665.88204764j   6979.5211824  +1390.43271033j
 -10172.19936049-12364.1006124j    6313.63812377 +1834.01437854j
   8669.26651597-10173.97306789j  -3454.95045875  +405.15922113j
   9055.10581532 +5935.94979149j  -2080.46290844 +1820.46593495j
  -5091.68435739+13538.05071441j   4820.25183191  -293.93937368j
  -9708.74423268 -1063.4163436j    5785.44623521 -1080.20401591j
   -709.32674111 -8503.13415789j    956.4101617   -225.67007868j
   8164.27495421  -526.9678322j   -4003.933074   -2422.50174549j
   1066.89939246+10223.0564717j   -3626.93692069 -2101.3101862j
  -7574.71901723 +2928.27217825j  -2313.33546502  +630.50194925j
  -6671.76465121 -7895.48893782j   -503.95115589  +894.18815845j
   5189.79186108 -6224.04824997j  -3519.43858445 +2782.33673271j
   6644.98390469 +6536.41833473j  -2818.79265125 +1578.26935j
  -5065.81776872 +6519.65902049j    108.42986948 +1745.88028132j
  -6341.23757247 -4001.45396711j   2991.13014031 +2633.86568173j
   1490.82680078 -5579.63731556j   -192.00423117 +3040.77652103j
   3673.39163188  +382.91233859j   -488.60007978  +266.64074572j]

step size: 1e-08
idx: range(0, 6)
Adjoint FOM: 1.9521017951340582
Adjoint gradient: [-19733.20236376+11332.71552179j   3740.19315245  +356.44822373j
  -8998.8322924 -13746.98126957j   3401.12825575 +6116.23951036j
  10437.8621641  -5812.62898697j  -3316.68259234 +2821.29527137j]

FD FOM: 1.9502895675625038
FD gradient: [-32.252567561119605, -28.901225324062807, -5.614595788294707, 26.43617631470363, -17.858767531464537, 51.131881351196284]

Now performing an optimization...

step size: 1e-09
Adjoint FOM: 1.9521028047618063
Adjoint gradient: [-19732.85397482+11332.73574177j   3740.145086    +356.44818501j
  -8998.5771015 -13746.97782714j   3401.01796523 +6116.2382285j
  10438.08493367 -5812.60560507j  -3316.76572543 +2821.28782822j
  10605.17642411+13047.7010341j    -879.98639543 +2693.52234031j
 -10823.19065314+10110.77444953j   4273.41216712 +1741.30668479j
 -13096.59399953 -8801.75321482j   7069.1588206  +4663.80373611j
   5262.76209212 -8481.91866877j   -191.10538731 +3477.12952511j
   8660.47338196 +6661.96620138j   1674.94033345 +2618.09039423j
  -5067.87987254+17656.35778699j   1877.74673144 +2482.41765189j
 -21094.42469023  +363.98709206j   9941.6877451  +3267.59390519j
  -2975.5643976 -12788.23924903j   5073.32688878 +4615.47382993j
  10939.77689994 -2752.41900508j  -1172.84823935 -1680.61682767j
   6275.73728928+12841.10914293j  -2067.53818002  +620.10419768j
 -12398.88407643 +7665.97452791j   6979.48258458 +1390.41408507j
 -10172.11456188-12364.07468835j   6313.59323818 +1833.99271771j
   8669.30087789-10174.00622282j  -3454.96017372  +405.16889435j
   9055.15043129 +5935.92650342j  -2080.46428177 +1820.4721969j
  -5091.6150755 +13538.06001331j   4820.23700055  -293.9442459j
  -9708.6434807  -1063.4032118j    5785.4023462  -1080.21012427j
   -709.19791192 -8503.10432688j    956.41058518  -225.66684827j
   8164.34419459  -526.93306655j  -4003.95618012 -2422.51530078j
   1066.98737492+10223.08008906j  -3626.9527092  -2101.3231575j
  -7574.60991566 +2928.27626738j  -2313.30103245  +630.50285211j
  -6671.59407989 -7895.48983796j   -503.96044551  +894.18917993j
   5189.9891441  -6224.03085204j  -3519.54561396 +2782.32409988j
   6645.12402162 +6536.47348676j  -2818.83682078 +1578.26470305j
  -5065.7881355  +6519.68557441j    108.4392386  +1745.88801155j
  -6341.20999435 -4001.46514314j   2991.11200696 +2633.87375897j
   1490.94111489 -5579.6414179j    -192.05467226 +3040.78108265j
   3673.52446346  +382.94343898j   -488.61562572  +266.63913891j]

..
----------------------------------------------------------------------
Ran 2 tests in 6701.839s

OK
..
----------------------------------------------------------------------
..
----------------------------------------------------------------------
Ran 2 tests in 6699.971s

OK
..
----------------------------------------------------------------------
Ran 2 tests in 6699.956s

OK
Ran 2 tests in 6699.946s

OK
.....
----------------------------------------------------------------------
Ran 2 tests in 6699.916s

OK

----------------------------------------------------------------------
Ran 2 tests in 6700.200s

OK
.
----------------------------------------------------------------------
Ran 2 tests in 6699.974s

OK
..
----------------------------------------------------------------------
Ran 2 tests in 6699.967s

...
----------------------------------------------------------------------
Ran 2 tests in 6701.644s

OK
OK
....
----------------------------------------------------------------------
.
Ran 2 tests in 6699.935s

OK
..----------------------------------------------------------------------
Ran 2 tests in 6699.923s


----------------------------------------------------------------------
Ran 2 tests in 6699.935s

OK
..OK


----------------------------------------------------------------------
Ran 2 tests in 6699.924s

OK
.----------------------------------------------------------------------
Ran 2 tests in 6699.925s

OK
...
----------------------------------------------------------------------
Ran 2 tests in 6699.918s

OK

----------------------------------------------------------------------
Ran 2 tests in 6699.946s

OK
step size: 1e-09
idx: range(0, 6)
Adjoint FOM: 1.9521028047618063
Adjoint gradient: [-19732.85397482+11332.73574177j   3740.145086    +356.44818501j
  -8998.5771015 -13746.97782714j   3401.01796523 +6116.2382285j
  10438.08493367 -5812.60560507j  -3316.76572543 +2821.28782822j]

FD FOM: 1.9502885600675697
FD gradient: [381.1600893799394, 310.18250779002443, 306.0219793127317, 14.386916991071528, -156.42438289109606, 301.1936016150685]

..
----------------------------------------------------------------------
Ran 2 tests in 6701.642s

OK
..
----------------------------------------------------------------------
Ran 2 tests in 6699.924s

OK
..
----------------------------------------------------------------------
Ran 2 tests in 6699.953s

OK
..
----------------------------------------------------------------------
Ran 2 tests in 6699.933s

OK
